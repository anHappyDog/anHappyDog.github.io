---
title: 计网链路层
author: lonelywatch
date: 2024-4-21 21:28 +0800
categories: [INTERNET]
tags: [INTERNET] 
---

# 记录链路层

链路层主要考察其中的三个问题：**封装成帧**，**透明传输**与**差错检测**；除此之外还介绍了两种通信协议，分别是: **点对点通信**与**广播通信**。其中参杂一些每部分相关的具体内容。

- 链路： 相邻两节点之间的物理路线
- 数据链路: 相邻两节点之间包括软件协议与物理链路
- 帧：数据链路层的协议数据单元
- IP数据报：网络层的协议数据单元

## 封装成帧

- **封装成帧**：在一段数据前后分别添加首部与尾部，用于帧定界与传递信息；帧定界可以使用特殊的字符：`SOH`(0x1)与`EOT`(0x4)分别表明帧的开始与结尾。

- **MTU**:数据部分长度上限。

## 透明传输

- **字符填充**：由于帧定界符可能出现在数据部分，所以使用`ESC`(0x1B)作为转义以供区分： 在发送方，对数据中出现的SOH，EOT与ESC的前方都添加ESC用于转义，然后发送；在接收方，则删除数据段中的曾插入的转义符，之后传入网络层。

## 差错检测

- **误码率**：出错字节 / 总字节

链路中可能会出现**比特差错**（0变成1，1变成0），需要使用一些方法进行检验，比如`CRC`(循环冗余检验)。

---

​	将数据划分成若干组，每组$k$字节，在每组数据后添加$n$位冗余码，一共发送$k+ n$ 位；对于这$n$位冗余码，则可以如此得到：

- 将$k$数据左移$n$位
- 除以发送接收双方事先决定的$n + 1$位除数$P$
- 得到$n$位余数$R$作为其冗余码

这一段冗余码则被称为**FCS**(帧检测序列)。

​	接收方使用收到的数据同样除上$P$,如果检查余数$R$，如果$R$为0则帧无差错。

---

​	差错检测仅保证链路层**当前收到的**帧无差错，不保证漏传，重传，失序等错误。

## 点对点通信

**PPP**通信的主要流程为：

- 发送方链路层将网络层传下的IP数据报封装成帧
- 发送方将封装帧发送给接收方的数据链路层
- 接收方检测接收到的帧是否出现差错，否则丢弃。

**PPP**协议主要包含3部分：

- 将IP数据报封装成帧并发送的方法。
- 链路控制协议**LCP**。
- 网络控制协议**NCP**。

### 协议报文格式

#### 首部

- F : 1字节，0x7E表示帧开始
- A: 1字节，0xFF
- C: 1字节，0x03
- 协议： 2字节，表明使用协议

#### 数据部分

不超过1500字节。

#### 尾部

- FCS: 2字节,用于接收端检测差错
- F: 1字节, 0x7E表示帧结束

---

如之前所说的三个问题，对于封装成帧，PPP中的帧定界符号为0x7E;对于透明传输,异步传输与同步传输则有所不同，对于**异步传输**，PPP使用0x7D作为转义字符，并且转义规则如下：

- 对于信息字段中的0X7E,转化为0X7D,0X5E
- 对于信息字段中的0X7D,转化为0X7D,0X5D
- 对于信息字段中的小于0x20的字符，则会在前面添加0X7D,同时将该字符加上0x20。

对于**同步传输**,PPP使用**零比特传输**:

- 在发送端但凡发现五个连续的1，则在后方添加一个0，避免信息部分出现帧定界符。

### 工作状态

- 拨号并建立物理连接
- 发送LCP分组，建立LCP连接，用于传递PPP需要使用的参数
- 发送NCP分组，分配临时IP地址
- 使用网络
- NCP释放网络层连接
- LCP释放链路层连接
- 物理层连接被释放

> 注： 复习时请务必注意 PPP建立连接与断开连接的过程与状态转移图。

## 广播通信

​	局域网使用广播信道，具有一对多传播的功能，其主要特点为： **被一个单位所拥有，且地理范围和站点范围都有限**，按照网络拓扑可分为： 星型网，环形网与总线网。

### CSMA/CD协议

> 注： 这里请务必注意，再次复习请重新填写。

## MAC物理地址

MAC帧格式有两种标准，分别是`DIX Ethernet V2`和IEEE的`802.3`标准



