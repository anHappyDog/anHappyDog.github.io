---
title: 操作系统
author: lonelywatch
date: 2024-06-05 21:28 +0800
categories: [OS]
tags: [OS]   
---


# 操作系统

操作系统可以被理解为特殊的应用程序，是用户与计算机硬件系统之间的接口。操作系统的主要功能是管理计算机系统的硬件资源，提供用户与计算机硬件系统之间的接口，为用户提供一个方便、安全、高效的工作环境。

## 引导

## 线程与进程

进程与线程都是对执行任务的抽象，只是其聚焦点不同。

### 进程

在进程模型中，所有计算机上可运行的软件，被组织成若干进程。**进程就是正在执行程序的实例**，除了程序本身的代码与数据外，其拥有若干资源，包括寄存器，内存，文件，CPU等（这当然也可以理解为对进程某一时刻状态的抽象，或者说是**上下文**，用于实现若干进程在同一CPU上运行）。

进程拥有一定空间的状态，通常包括： 就绪，运行，阻塞，终止。或者也可以将终止删除。 对于使用某些资源频繁的进程，通常可分为 CPU密集型和IO密集型进程。对于IO密集型进程，进程数量的增长往往能够很好地提高CPU利用率。

操作系统为了管理进程，通常会在内核中存放一张进程表，其中每一项都是一个进程控制块（PCB），用于存放进程的信息，包括进程的状态，进程ID，进程的优先级，进程的寄存器，进程的内存分配，进程的文件描述符等，也就是之前提到的进程上下文。

### 线程

线程具有进程的某些特征，是建立在进程上的新抽象。进程拥有若干线程，线程能够共享进程的地址空间进而共享可用数据，因而比进程更为轻量。



### IPC通信

### 调度

调度就是选择某一任务执行。这一过程通常发生在：

1. 某任务退出时
2. 创建新任务时
3. 任务被阻塞时
4. IO中断发生时

调度算法对于不同环境有不同的要求，大致可分为三类环境，分别为： 批处理，交互时，实时。 

批处理通常处理大量周期性的任务，适合非抢占算法或者长时间周期的抢占式算法，尽可能提高系统的吞吐量和CPU利用率，并且降低CPU周转时间；

- 周转时间： 一批处理作业提交时刻到完成为止地统计平均时间

交互式通常需要抢占式算法来提供良好的响应速度和均衡性。 

实时环境比较特殊，或多或少使得每一任务满足截止时间，并且任务的执行时间往往可预测。

除了每一类环境特定要求外，调度算法还应尽可能地满足 公平，系统策略强制执行以及高资源利用率等要求。

#### 批处理

##### 先来先服务（FCFS）

非抢占式算法的一种。任务按照其请求CPU的顺序来使用CPU。任务运行时不会受到中断，直到任务阻塞时，就会切换到其队列中位于该任务之后的任务执行；当任务从阻塞中恢复就绪时，就会被放到队列的尾部。

##### 短作业优先（SJF）

非抢占式算法的一种。该算法假设所有的任务执行时间已知，每次选择执行时间最短的任务。

##### 最短剩余时间优先（SRTF）

短作业优先的抢占式版本。调度程序总是选择剩余时间最短的任务执行。

#### 交互式

##### 轮转 (RR)

抢占式算法的一种。每个任务被分配一个时间片，当时间片用完时，任务被放到队列的尾部，然后调度下一个任务;如果任务提前结束或阻塞，就切换任务并将该任务移出队列或者放到队列的尾部。

需要注意轮转算法的时间片，时间片过大会导致任务响应时间过长，时间片过小会导致任务切换过于频繁。

##### 优先级调度 (PS)

抢占式算法的一种，每一任务具有某一优先级，优先级最高的可运行任务先运行。为了防止高优先级进程一直运行，调度程序可以在每次时钟中断时降低当前进程的优先级，如果存在更高优先级的进程，就进行进程切换。 一种实现为：对于每一优先级拥有一个任务队列，每个队列使用轮转算法，同时实现之前的优先级变换。

##### 多级队列调度 (MLQ)

多级队列调度是一种综合了轮转和优先级调度的算法。将任务分为多个队列，每个队列使用不同的调度算法，例如：高优先级队列使用轮转算法，低优先级队列使用优先级调度算法。当一个任务进入系统时，首先进入高优先级队列，当高优先级队列为空时，才会进入低优先级队列。

##### 彩票调度 (LOTTERY)

彩票调度是一种随机调度算法，每个任务被分配一定数量的彩票，调度程序在每次时钟中断时，从所有彩票中随机选择一个任务执行。这种算法可以实现公平性，但是可能会导致任务的响应时间不稳定。

#### 实时环境

实时环境通常可分为硬实时与软实时。硬实时要求任务必须在截止时间前完成，而软实时则要求任务尽量在截止时间前完成，但是允许一定的延迟。

实时环境中的事件通常可分为周期性与非周期性。对于周期性事件，只有当每一事件处理时间与对应周期之比 的总和小于等于1时，该系统才是可调度的（建立在上下文切换代价忽略不计的前提下）。

#### 进程与线程

进程与线程的调度是两个层级，并且线程的调度方式往往取决于其是否是内核线程。内核线程是由操作系统管理的线程，而用户线程则是由用户库管理的线程。对于用户线程，内核的调度程序并不知道线程的存在，所以按照之前所说对进程进行调度。 进程下的所有线程由该进程的线程调度程序进行调度；对于内核线程，内核调度的对象其实是线程，在调度时，选择某一线程进行调度（通常并不选择特定的进程下的线程）。

内核线程与用户级线程区别在于：

1. 内核线程切换时需要类似于进程切换的开销，而用户级线程并不需要

2. 内核级线程在IO阻塞时不会阻塞整个进程，而用户级线程会

3. 内核级线程可以利用多核，而用户级线程不行


## 存储管理



## 并发与锁

## 文件系统

## IO与设备管理

