---
title: 计算机组成原理
author: lonelywatch
date: 2024-06-05 21:28 +0800
categories: [CO]
tags: [CO]   
---


# 计算机组成原理

## 961大纲

- 单处理器计算机**组成部分**，**连接方式**及**内部工作原理**。

- **计算机系统的层次结构**与MIPS指令集体系结构，能够熟练使用MIPS汇编。

- **存储系统的层次化结构**，对存储系统的设计，分析和性能计算。

- 对单周期，多周期，流水线处理器的设计，分析和性能计算。

### 主要内容

- 计算机系统的性能指标：吞吐量、响应时间、带宽、延迟；CPU时钟周期、主频、CPI、CPU执行时间；MIPS、MFLOPS、GFLOPS、TFLOPS、PFLOPS。

- 数据的表示和运算： 数制与编码，定点数与浮点数表示和运算，ALU，串并行加法器。

- 存储器层次结构：层次化结构，主存与CPU的连接，Cache的工作原理，映射方式，主存块的替换算法与写策略，多层Cache的性能计算；TLB，虚拟存储器

- MIPS指令系统及汇编语言

- MIPS处理器：单周期，多周期，流水线设计

- 总线与IO： 总线，磁盘，IO，基本IO方式（轮询，中断,DMA）

参考书目： 计算机组成原理MIPS第五版


## 概述

### 计算机体系结构重要思想

计算机体系结构中的8个伟大思想主要包括：

1. 摩尔定律： 单芯片的集成度约18~24月翻倍。

2. 使用抽象来简化设计： 使用抽象来表示不同设计层次，使得高层次屏蔽低层次细节来减低设计复杂度。

3. 加速大概率事件： 通过加速大概率事件优化远比加速小概率事件更有效。大概率事件往往更为简单，从而易于提高。

4. 通过并行提高性能。

5. 通过流水线提高性能。

6. 通过预测提高性能。

7. 存储器层次：基于不同类型存储器的容量，性能等限制，将存储器分为多层次，以利用多种存储器的特点从而提高性能。

8. 通过冗余来提高可靠性。

系统软件作为应用程序与硬件的交互接口，主要包括操作系统与编译器两部分。操作系统被定义为管理计算机资源的软硬件交互接口。编译器是将高级程序语言翻译成机器码的程序。

就计算机软件而言，从机器码到汇编程序最后再到高级程序语言这一转变，是计算机早期的重大突破，极大地提高了程序开发效率，是抽象思想的很好体现。将高级程序语言翻译成机器码主要由**编译器**实现。

### 计算机组成部件

计算机由完成输入，输出，处理和存储数据任务的5类部件构成，其中两个关键部件为**输入设备**与**输出设备**。该5类部件分别为：输入，输出，存储器，数据通路，控制器。其中最后两个部件通常合称为处理器。

- 输入设备： 用于将外部数据输入到计算机中，如键盘，鼠标，扫描仪等。
- 输出设备： 用于将计算机处理后的数据输出到外部，如显示器，打印机等。

**内存**是指程序运行时的存储空间，DRAM则是**动态随机访问存储器**的缩写。内存通常由多片DRAM组成。**缓存**Cache是一种小而快的存储器，一般作为DRAM的缓冲，通常使用SRAM(静态随机访问存储器)。SRAM比DRAM更快，但是集成度更低。内存被称为**易失性存储器**，如果失电则失去所有数据；与之相对的则是**非易失性存储器**。前者被称为**主存储器**，而后者被称为**二级存储器**。

### 指令集体系结构

**指令集体系结构是对硬件与底层软件之间的抽象**，其通常包括编写机器语言程序所需的全部信息。提供给应用程序员的基本指令集与操作系统接口合称为**应用二进制接口**。

### 处理器与存储器制造技术

从真空管，到晶体管（由电信号控制的简单开关），到最后的超大规模集成电路（IC,由极大数量晶体管组成的电路）。芯片基于半导体硅材料，从硅锭开始，经过切片机切成厚度不超过0.1英寸的晶圆。晶圆包含若干芯片来避免瑕疵循环所有芯片，由此成品率则是芯片生产的重要指标，主要是指合格芯片数占总芯片数的比例，芯片价格与成品率计算公式如下：

![](https://lonelywatch-1306651324.cos.ap-beijing.myqcloud.com/image-20240910141830952.png)

### 性能

- 响应时间：也称执行时间，是指计算机完成所任务所需的总时间。

- 吞吐量： 也称带宽，表示单位时间内完成的任务数量。

- 墙上时钟时间：Wall Clock Time，也称响应时间。

- CPU执行时间：指在CPU上花费的时间，不包括IO与运行其他运行程序的时间。可进一步分为系统CPU时间与用户CPU时间。

- **时钟周期**： 时钟间隔的时间。

- **时钟频率**: 时钟周期的倒数。

**CPI**(Clock cycle per instruction) 是指执行每条指令所需的时钟周期的平均值。

程序CPU执行时间 = 程序CPU时钟周期数 X 时钟周期时间

CPU时钟周期数 = 程序指令数 X 每条指令的平均时钟周期数 = 程序指令数 X CPI X 时钟周期时间
= 程序指令数 X CPI / 时钟频率

- 指令数: 执行某程序所需的指令数量

**执行时间** = 秒/程序 = 指令数/程序 X 时钟周期数 / 指令 X 秒 / 时钟周期

功耗墙： 由于功耗与性能之间的矛盾，导致了功耗墙的出现，即在一定功耗下，性能无法继续提高。

- **MIPS**(million instructions per second):每秒执行的百万条指令数。

  - **MIPS** = 指令数 / (执行时间 X 10^6)

  - **MIPS** = 指令数 / (指令数 X CPI/时钟频率 X 10^6) = 时钟频率 / (CPI X 10^6)

**MFLOPS**指每秒进行百万次浮点计算次数，**GFLOPS**指每秒进行十亿次浮点计算次数，**TFLOPS**指每秒进行万亿次浮点计算次数，**PFLOPS**指每秒进行10^15次浮点计算次数,**EFLOPS**指每秒进行10^18次浮点计算次数,**ZFLOPS**指每秒进行10^21次浮点计算次数。

基准程序（Benchmark）是指专门用来进行性能评价的一组程序，用于反应机器在运行实际负载时的性能。

## 数制表示

## MIPS汇编语言


## 处理器



## 存储器层次

存储器层次架构是指一种由多种存储器层次组成的结构，其容量与访问时间离处理器距离的增加而增加。

存储器层次架构主要基于**局部性原理**，主要体现为：

- **时间局部性**： 如果一个信息项被访问，那么在不久的将来它很可能再次被访问。

- **空间局部性**： 如果一个信息项被访问，那么与它相邻的信息项很可能也会被访问。

需要注意数据只能在相邻的两个层次之间进行复制，交换的最小单元为**块**或者称为**行**。

可以视为最底层存储器存储所有数据，而靠近处理器的存储器则存储较远存储器中的数据子集。如果需要的数据存放在高层存储器中的某个块，就称为**一次命中**，否则称为**一次缺失**。如果缺失则需要访问下一层存储器，这个过程称为**缺失处理**。**命中率**与**缺失率**是评价存储器层次结构性能的重要指标。**命中时间**是指访问高层存储器的时间，**缺失代价**是指将相应的块从底层存储器替换到高层并传送到处理器的时间之和。

### 存储技术

SRAM静态随机访问存储器是一种组织成存储阵列结构的简单集成电路，通常具有一个读写端口，对任何数据的访问时间都是固定的，并且不需要刷新。由于其访问时间与周期时间相近，为了防止读取时数据丢失，一个基本存储单元通常由6~8个晶体管组成。

DRAM动态随机访问存储器与SRAM不同，使用电容保存电荷的方式来存储数据，使用晶体管对电容访问，其集成度比SRAM高，价格更低，但是需要周期性刷新，所以被称之为动态。

DRAM采用了**两级译码结构**，通过一个读周期后紧跟一个写周期来刷新一整行。

![](https://lonelywatch-1306651324.cos.ap-beijing.myqcloud.com/image-20240912151016844.png)

> 图片来自原书



闪存是一种电可擦除的可编程只读存储器EEPROM。由于写操作会造成存储位损耗，大多数闪存都有一个控制器，用于将对已经写入多次的块的写操作映射到写入次数较少的块中，这一技术被称为**损耗均衡**。

磁盘

#### Cache

Cache由SRAM组成，是主存的缓冲，由一块块数据组成。Cache用于保存最近所访问过的数据，当CPU需要访问数据时，会首先查找Cache，如果Cache中有数据则为命中，否则导致了一次缺失，需要把数据从主存调入Cache中。

在Cache中找到对应的数据涉及到数据在Cache中的映射方式，常见的映射方式有：直接映射，全相联映射，组相联映射。

##### 直接映射

直接映射：一种Cache结构，主存的每个地址仅仅对应到cache中的一个位置。

如果Cache块数为2^m。

##### 全相联映射

##### 组相联映射

